{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const API_KEY = '50736279-c1f88b0db9e0d00ad72cdf14a';\nconst BASE_URL = 'https://pixabay.com/api/';\nimport axios from 'axios';\n\nexport async function getImagesByQuery(query, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 40,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error.message);\n    throw new Error(error.message);\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\n// Инициализация SimpleLightbox\nexport function initLightbox() {\n  if (lightbox) {\n    lightbox.destroy();\n  }\n  lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\n// Обновление SimpleLightbox\nexport function refreshLightbox() {\n  if (lightbox) {\n    lightbox.refresh();\n  }\n}\n\n// Создание галереи\nexport function createGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  if (!gallery) {\n    console.error('Gallery element not found');\n    return;\n  }\n\n  // Если нет изображений - показываем сообщение\n  if (!Array.isArray(images) || images.length === 0) {\n    gallery.innerHTML = `\n      <p class=\"no-results\">\n        Sorry, there are no images matching your search query. Please try again!\n      </p>\n    `;\n    return;\n  }\n\n  // Создаем разметку для галереи\n  const markup = images\n    .map(\n      image => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img \n          class=\"gallery-image\" \n          src=\"${image.webformatURL}\" \n          alt=\"${image.tags}\" \n          loading=\"lazy\" \n          width=\"360\"\n          height=\"200\"\n        />\n        <div class=\"image-info\">\n          <div class=\"info-item\">\n            <span class=\"info-label\">Likes</span>\n            <span class=\"info-value\">${image.likes}</span>\n          </div>\n          <div class=\"info-item\">\n            <span class=\"info-label\">Views</span>\n            <span class=\"info-value\">${image.views}</span>\n          </div>\n          <div class=\"info-item\">\n            <span class=\"info-label\">Comments</span>\n            <span class=\"info-value\">${image.comments}</span>\n          </div>\n          <div class=\"info-item\">\n            <span class=\"info-label\">Downloads</span>\n            <span class=\"info-value\">${image.downloads}</span>\n          </div>\n        </div>\n      </a>\n    </li>\n  `\n    )\n    .join('');\n\n  gallery.innerHTML = markup;\n  initLightbox();\n}\n\n// Добавление новых изображений для кнопки \"Load more\"\nexport function appendGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  if (!gallery) {\n    console.error('Gallery element not found');\n    return;\n  }\n\n  if (!Array.isArray(images) || images.length === 0) {\n    return;\n  }\n\n  const markup = images\n    .map(\n      image => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img \n          class=\"gallery-image\" \n          src=\"${image.webformatURL}\" \n          alt=\"${image.tags}\" \n          loading=\"lazy\" \n          width=\"360\"\n          height=\"200\"\n        />\n        <div class=\"image-info\">\n          <div class=\"info-item\">\n            <span class=\"info-label\">Likes</span>\n            <span class=\"info-value\">${image.likes}</span>\n          </div>\n          <div class=\"info-item\">\n            <span class=\"info-label\">Views</span>\n            <span class=\"info-value\">${image.views}</span>\n          </div>\n          <div class=\"info-item\">\n            <span class=\"info-label\">Comments</span>\n            <span class=\"info-value\">${image.comments}</span>\n          </div>\n          <div class=\"info-item\">\n            <span class=\"info-label\">Downloads</span>\n            <span class=\"info-value\">${image.downloads}</span>\n          </div>\n        </div>\n      </a>\n    </li>\n  `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  refreshLightbox();\n}\n\n// Очистка галереи\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  if (gallery) {\n    gallery.innerHTML = '';\n  }\n  if (lightbox) {\n    lightbox.destroy();\n    lightbox = null;\n  }\n}\n\n// Показать лоадер\nexport function showLoader() {\n  const loader = document.querySelector('.loader-container');\n  if (loader) {\n    loader.style.display = 'flex';\n  }\n}\n\n// Скрыть лоадер\nexport function hideLoader() {\n  const loader = document.querySelector('.loader-container');\n  if (loader) {\n    loader.style.display = 'none';\n  }\n}\n\n// Показать кнопку \"Load more\"\nexport function showLoadMoreButton() {\n  const loadMoreContainer = document.querySelector('.load-more-container');\n  if (loadMoreContainer) {\n    loadMoreContainer.style.display = 'flex';\n  }\n}\n\n// Скрыть кнопку \"Load more\"\nexport function hideLoadMoreButton() {\n  const loadMoreContainer = document.querySelector('.load-more-container');\n  if (loadMoreContainer) {\n    loadMoreContainer.style.display = 'none';\n  }\n}\n\n// Функция для показа сообщения \"нет результатов\"\nexport function showNoResultsMessage() {\n  const gallery = document.querySelector('.gallery');\n  if (gallery) {\n    gallery.innerHTML = `\n      <p class=\"no-results\">\n        Sorry, there are no images matching your search query. Please try again!\n      </p>\n    `;\n  }\n}\n\n// Функция для показа сообщения об ошибке\nexport function showErrorMessage(message) {\n  const gallery = document.querySelector('.gallery');\n  if (gallery) {\n    gallery.innerHTML = `<p class=\"no-results\">${message}</p>`;\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  appendGallery,\n  refreshLightbox,\n  showNoResultsMessage,\n  showErrorMessage,\n} from './js/render-functions.js';\n\n// Элементы DOM\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\n// Переменные состояния\nlet currentPage = 1;\nlet currentQuery = '';\nlet isLoading = false;\nlet totalHits = 0;\nlet loadedHits = 0;\n\n// Изначально скрываем кнопку Load more\nhideLoadMoreButton();\n\n// Обработчик формы\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  // Получаем поисковый запрос\n  const searchInput = form.elements['search-text'];\n  const searchQuery = searchInput.value.trim();\n\n  // Проверка на пустой запрос\n  if (!searchQuery) {\n    showWarning('Please enter a search term');\n    return;\n  }\n\n  // Если уже идет загрузка - выходим\n  if (isLoading) return;\n\n  // Сбрасываем состояние\n  currentQuery = searchQuery;\n  currentPage = 1;\n  isLoading = true;\n\n  // Показываем лоадер, скрываем кнопку Load more\n  showLoader();\n  hideLoadMoreButton();\n\n  // Очищаем галерею\n  clearGallery();\n\n  try {\n    // Делаем запрос к API\n    const data = await getImagesByQuery(searchQuery, currentPage);\n\n    // Скрываем лоадер\n    hideLoader();\n    isLoading = false;\n\n    // Проверяем наличие результатов\n    if (!data.hits || data.hits.length === 0) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      showNoResultsMessage();\n      return;\n    }\n\n    // Сохраняем общее количество найденных изображений\n    totalHits = data.totalHits;\n    loadedHits = data.hits.length;\n\n    // Показываем галерею\n    createGallery(data.hits);\n\n    // Проверяем, нужно ли показывать кнопку Load more\n    if (loadedHits < totalHits) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    // Скрываем лоадер в случае ошибки\n    hideLoader();\n    isLoading = false;\n\n    // Показываем сообщение об ошибке\n    showError('An error occurred while fetching images. Please try again.');\n    showErrorMessage('Error loading images. Please try again.');\n  }\n});\n\n// Обработчик кнопки Load more\nloadMoreBtn.addEventListener('click', async () => {\n  // Если уже идет загрузка или нет больше изображений - выходим\n  if (isLoading || loadedHits >= totalHits) return;\n\n  isLoading = true;\n  showLoader();\n\n  try {\n    currentPage++;\n\n    // Делаем запрос к API\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    // Если нет новых изображений\n    if (!data.hits || data.hits.length === 0) {\n      hideLoadMoreButton();\n      showInfo('No more images to load.');\n      return;\n    }\n\n    // Добавляем новые изображения в галерею\n    appendGallery(data.hits);\n    loadedHits += data.hits.length;\n\n    // Обновляем SimpleLightbox\n    refreshLightbox();\n\n    // Прокручиваем страницу к новым изображениям\n    const galleryItems = document.querySelectorAll('.gallery-item');\n    if (galleryItems.length > 0) {\n      const lastItem = galleryItems[galleryItems.length - 1];\n      lastItem.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n    }\n\n    // Проверяем, нужно ли еще показывать кнопку Load more\n    if (loadedHits >= totalHits) {\n      hideLoadMoreButton();\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (error) {\n    // В случае ошибки возвращаемся на предыдущую страницу\n    currentPage--;\n\n    // Показываем сообщение об ошибке\n    showError('Failed to load more images. Please try again.');\n  } finally {\n    // Всегда скрываем лоадер\n    hideLoader();\n    isLoading = false;\n  }\n});\n\n// Функции для уведомлений (только iziToast, без работы с DOM)\nfunction showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n    timeout: 5000,\n    backgroundColor: '#EF4040',\n    theme: 'dark',\n    progressBarColor: '#D32F2F',\n  });\n}\n\nfunction showWarning(message) {\n  iziToast.warning({\n    title: 'Warning',\n    message: message,\n    position: 'topRight',\n    timeout: 3000,\n    backgroundColor: '#FFC107',\n    theme: 'dark',\n    progressBarColor: '#FFA000',\n  });\n}\n\nfunction showInfo(message) {\n  iziToast.info({\n    title: 'Info',\n    message: message,\n    position: 'topRight',\n    timeout: 3000,\n    backgroundColor: '#4e75ff',\n    theme: 'dark',\n    progressBarColor: '#6c8cff',\n  });\n}\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","params","axios","error","lightbox","initLightbox","SimpleLightbox","refreshLightbox","createGallery","images","gallery","markup","image","appendGallery","clearGallery","showLoader","loader","hideLoader","showLoadMoreButton","loadMoreContainer","hideLoadMoreButton","showNoResultsMessage","showErrorMessage","message","form","loadMoreBtn","currentPage","currentQuery","isLoading","totalHits","loadedHits","searchQuery","showWarning","data","showError","showInfo","galleryItems","iziToast"],"mappings":"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"}